<!DOCTYPE html><html lang="en"><head><title>ASTã§åƒ•ã®è€ƒãˆãŸæœ€å¼·ã®DXã‚’å®Ÿç¾ã™ã‚‹ ã€œè‡ªåˆ†ã®DXã¯è‡ªåˆ†ã§å®ˆã£ã¦ã„ã‘ã€œ | shinyaigeek.dev</title><meta charset="utf8"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><meta property="og:title" content="ASTã§åƒ•ã®è€ƒãˆãŸæœ€å¼·ã®DXã‚’å®Ÿç¾ã™ã‚‹ ã€œè‡ªåˆ†ã®DXã¯è‡ªåˆ†ã§å®ˆã£ã¦ã„ã‘ã€œ | shinyaigeek.dev"><meta property="og:site_name" content="shinyaigeek.dev"><meta property="og:locale" content="ja_JP"><meta name="description" content="Web ãŒå¥½ããªã‚ªã‚¿ã‚¯ã®ãƒ–ãƒ­ã‚°. ä¸»ã«webé–‹ç™ºã®çŸ¥è¦‹ã«ã¤ã„ã¦å–‹ã‚Šã¾ã™"><meta property="og:description" content="Web ãŒå¥½ããªã‚ªã‚¿ã‚¯ã®ãƒ–ãƒ­ã‚°. ä¸»ã«webé–‹ç™ºã®çŸ¥è¦‹ã«ã¤ã„ã¦å–‹ã‚Šã¾ã™"><meta property="og:url" content="https://shinyaigeek.dev/en/post/introduction-to-AST"><meta name="twitter:site" content="@shinyaigeek"><meta property="og:type" content="website"><meta name="twitter:card" content="summary_large_image"><meta property="og:image" content="https://en.shinyaigeek.dev/assets/ogimage/en/introduction-to-AST.png"><meta name="twitter:image" content="https://en.shinyaigeek.dev/assets/ogimage/en/introduction-to-AST.png"><link rel="icon" type="image/x-icon" href="/assets/static/favicon.ico"><link rel="stylesheet" type="text/css" href="/assets/styles.ada9902fc362b01889c3.css"><link rel="stylesheet" type="text/css" href="/assets/static/a11y-dark.min.css"><link rel="stylesheet" href="https://unpkg.com/github-calendar@latest/dist/github-calendar-responsive.css"><link rel="preload" as="style" href="/assets/static/a11y-dark.min.css"><link rel="preload" as="style" href="/assets/styles.ada9902fc362b01889c3.css"><link rel="preload" as="style" href="https://unpkg.com/github-calendar@latest/dist/github-calendar-responsive.css"><link rel="preload" as="image" href="/assets/static/icon_transparent_header.png"><link rel="alternate" type="application/rss+xml" title="shinyaigeek.dev" href="/rss.xml"></head><body><div id="_app"><div class="fmapAu0fpx364Dzl_9z0"><div class="J2e3WZniL57BvLtita5T"><div class="kVHiWHyN1gv5Y41SpACy"><a href="/" class="link2Home"><div><img src="/assets/static/icon_transparent_header.png" alt="icon" class="vwQ8HQPKPoICc2atrDju" width="36px" height="36px">shinyaigeek.dev</div></a></div><div class="hOkVSJvM823tjX0FjgO_"><div class="FpNMxf5Gx0pwkDBdeqif"><details><summary> <span role="img" aria-label="language"><g-emoji fallback-src="/assets/static/earth_africa.png" alias="earth">ğŸŒ</g-emoji></span> English</summary><div class="ZAVxrSvsXSeI9pV9Rbax"><a href="http://ja.shinyaigeek.dev/post/introduction-to-AST" class="aYFqAG93sRJ7BJMCPjsa"><span role="img" aria-label="country"><g-emoji fallback-src="/assets/static/jp.png" alias="Japan">ğŸ‡¯ğŸ‡µ</g-emoji></span>æ—¥æœ¬èª</a><a href="https://en.shinyaigeek.dev/post/introduction-to-AST" class="aYFqAG93sRJ7BJMCPjsa undefined"><span role="img" aria-label="country"><span><g-emoji fallback-src="/assets/static/us.png" alias="America">ğŸ‡ºğŸ‡¸</g-emoji><g-emoji fallback-src="/assets/static/gb.png" alias="United States">ğŸ‡¬ğŸ‡§</g-emoji></span></span>English</a></div></details></div><div class="FpNMxf5Gx0pwkDBdeqif"><a href="/" class="link2Home">Blog</a></div><div class="FpNMxf5Gx0pwkDBdeqif"><a href="/profile" id="link2profile">Profile</a></div><div class="FpNMxf5Gx0pwkDBdeqif"><a href="https://github-activity.shinyaigeek.dev/" id="link2activity">Activity</a></div></div></div><div class="sxaQUUuymSmhNwqAMaks"><div><details class="h0AHqg9AmVXjXCnYqFqc"><summary class="post--anchor__title" id="post--anchor__title">Table of Contents</summary><a href="#2__0">TL;DR</a><a href="#2__1">AST ã¨ã¯</a><a href="#2__2">ASTãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ã‚‚ã®</a><a href="#2__3">ASTã§ã‚³ãƒ¼ãƒ‰ã‚’ã„ã˜ã„ã˜ã™ã‚‹ã¨ãã®ã‚ã‚Œã“ã‚Œ</a><a href="#2__4">ASTã‚’è©¦ã—ã¦ã¿ã‚‹</a><a href="#2__5">ã¾ã¨ã‚</a></details><div class="Y8c8TlU3k_Y72ndSGmnk"><h1>ASTã§åƒ•ã®è€ƒãˆãŸæœ€å¼·ã®DXã‚’å®Ÿç¾ã™ã‚‹ ã€œè‡ªåˆ†ã®DXã¯è‡ªåˆ†ã§å®ˆã£ã¦ã„ã‘ã€œ</h1><div>2020/09/12</div><div class="BYkaTwWlH4C2pP1hi2JY"><div>JavaScript</div><div>AST</div></div></div><div class="L6tHhpo3uw534DnsakEH"><h2 id="2__0">TL;DR</h2>
<p>ASTã‚¤ã‚¸ã‚¤ã‚¸ã™ã‚‹ã®ã¯ã„ã„ãï¼ï¼</p>
<ul>
<li>é›£ã—ããªã„</li>
<li>è‡ªåˆ†ã®DXã‚’è‡ªåˆ†ã§å®ˆã‚‹ã¨ã„ã†ã‚¨ã‚­ã‚µã‚¤ãƒ†ã‚£ãƒ³ã‚°ãªä½“é¨“ãŒã§ãã‚‹</li>
<li>è§¦ã‚Œã‚‹ç¯„å›²ãŒåºƒãŒã‚‹</li>
<li>ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’ã‚„ã‚‹é™ã‚ŠãŠä¸–è©±ã«ãªã‚‹</li>
</ul>
<p>ã¨è‰¯ã„ã“ã¨ã¥ãã‚ã§æœ€é«˜ãªã®ã§å¸ƒæ•™ã—ãŸã„</p>
<p>ã¾ãŸ, ã“ã®ãƒ–ãƒ­ã‚°ã¯ <a href="https://docs.google.com/presentation/d/1Ykka2_NvseClPO2J_oFqRUb_sD6rZfYBU-XWnsdTn9U/edit?usp=sharing">https://docs.google.com/presentation/d/1Ykka2_NvseClPO2J_oFqRUb_sD6rZfYBU-XWnsdTn9U/edit?usp=sharing</a> ã®è£œåŠ©è³‡æ–™ã§ã™. ã¾ã‚ã“ã®è¨˜äº‹ã®æ–¹ã‚’èª­ã‚ã°å¤§ä¸ˆå¤«ã§ã™å¤§ä¸ˆå¤«ã§ã™.</p>
<h2 id="2__1">AST ã¨ã¯</h2>
<p>ASTã¨ã¯ <strong>A</strong>bstract <strong>S</strong>ntax <strong>T</strong>ree ã®ç•¥ã§ã™. æ—¥æœ¬èªã§ã„ã†ã¨ <strong>æŠ½è±¡æ§‹æ–‡æœ¨</strong> ã¨ã„ã†ã‚„ã¤ã§ã™.
<strong>Tree</strong> ã¨ã‚ã‚‹ã‚ˆã†ã«, ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®æ–‡æ³•æ§‹é€ ã‚’ <strong>Tree</strong> æ§‹é€ ã§è¡¨ç¾ã—ãŸã‚‚ã®ã«ãªã‚Šã¾ã™.
Tree æ§‹é€ ãªã®ã§, ãã‚Œãã‚Œã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç¯€ã€…ã‚’ <strong>Node</strong> ã¨è¨€ã„ã¾ã™.</p>
<pre><code class="hljs language-javascript">
<span class="hljs-keyword">if</span>( hoge === <span class="hljs-string">"bar"</span> ) {
  <span class="hljs-title function_">foga</span>();
}

</code></pre>
<p>ä¾‹ãˆã°ã§ã™ãŒ, ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã® AST ã¯ã©ã®ã‚ˆã†ãªã‚‚ã®ã«ãªã‚‹ã‹è¦‹ã¦ã¿ã¾ã—ã‚‡ã†.</p>
<p><img src="/assets/introduction-to-AST/ast-tree.png" alt="ast"></p>
<p>ifæ–‡ã‚’åˆ†è§£ã—ã¦ã¿ã¾ã—ã‚‡ã†.
ifæ–‡ã¯ã€Œã‚‚ã—ã€œã€œãªã‚‰ã€ã€œã€œã™ã‚‹ã€ã¨ã„ã†ã“ã¨ã‚’è¨˜è¿°ã§ãã¾ã™ã­ã€‚
ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€ã€Œã‚‚ã— hoge ãŒ "bar" ã¨ã„ã† string literal å€¤ã ã£ãŸã‚‰, fuga ã¨ã„ã†é–¢æ•°ã‚’å¼•æ•°ãªã—ã§å®Ÿè¡Œã™ã‚‹ã€ã¨ã„ã†æ„Ÿã˜ã§ã™ã­.
ASTä¸Šã ã¨ã€ã¾ãš <code>ifStatement</code> ã¨ã„ã† Node ãŒç™»å ´ã—ã¾ã™.
ãã—ã¦, ãã® <code>if</code> ã®å­ã® Node ã¨ã—ã¦, <code>if</code> æ–‡ã®ã€Œæ¡ä»¶å¼ã€ã‚„, ãã®ã€Œæ¡ä»¶ã‚’æº€ãŸã™æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹å‡¦ç†ã€ãŒå…¥ã‚Šã¾ã™ã€‚
ãã—ã¦æ¡ä»¶å¼ã®ä¸­ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†.
æ¡ä»¶å¼ã®ä¸­ã¯ã€ã¾ãš <code>Binary Expression</code> ã¨ã„ã† Node ãŒç™»å ´ã—ã¾ã™. ã“ã‚Œã¯äºŒé …æ¼”ç®—å¼ã§, äºŒã¤ã®å€¤ã‚’æ¯”è¼ƒã—ãŸã‚Š, ã¨ã„ã†ã“ã¨ã‚’ã—ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã­(å›³ã§ã¯ç°¡ç•¥ã®ãŸã‚çœç•¥ã—ã¦ã„ã¾ã™)
ã§, <code>Binary Expression</code> ã§å…·ä½“çš„ã«ä½•ã‚’ã—ã¦ã„ã‚‹ã‹ã¨ã„ã†è©±ã«ãªã‚‹ã®ã§ã™ãŒ,</p>
<ul>
<li>ç­‰ã—ã„ã‹ã©ã†ã‹</li>
<li><code>hoge</code> ã¨ã„ã†å¤‰æ•°</li>
<li>"bar" ã¨ã„ã† string literalå€¤</li>
</ul>
<p>ã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã™ã­.</p>
<p>ã“ã®ãƒ–ãƒ­ã‚°(ç™ºè¡¨)ã§ã¯, ASTã‚’ã‚¤ã‚¸ã‚¤ã‚¸ã™ã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‹ã‚‰ code ã«å¯¾ã—ã¦ä»‹å…¥ã—ä½•ã‚‰ã‹ã® mutation ã‚’è¡Œãªã£ã¦ã„ããƒ—ãƒ­ã‚»ã‚¹ã‚’è§£èª¬ã—ã¦ã„ãã¾ã™.</p>
<h2 id="2__2">ASTãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ã‚‚ã®</h2>
<p><img src="/assets/introduction-to-AST/ast-tool.png" alt="ast-tool"></p>
<p>JSã§ã„ãˆã°, babel, eslint, prettier, webpack, ãªã©ãªã©, ç§ãŸã¡ã®é–‹ç™ºè€…ä½“é¨“ã‚’æ½¤ã™æ§˜ã€…ãªãƒ„ãƒ¼ãƒ«ãŒASTã‚’ç”¨ã„ã¦ã„ã¾ã™.</p>
<p>åƒ•ã¯JSã°ã‹ã‚Šæ›¸ã„ã¦ã„ã‚‹ã®ã§JSã®ä¾‹ã—ã‹å‡ºã›ã¾ã›ã‚“ãŒ, ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ‰±ã†ä»¥ä¸Š, ã»ã¼ã»ã¼å¿…ãšã©ã“ã‹ã§ãŠä¸–è©±ã«ãªã£ã¦ã„ã‚‹ã¨ã„ã£ã¦ã‚‚éè¨€ã¯ãªã„ã¯ãšã§ã™.</p>
<h2 id="2__3">ASTã§ã‚³ãƒ¼ãƒ‰ã‚’ã„ã˜ã„ã˜ã™ã‚‹ã¨ãã®ã‚ã‚Œã“ã‚Œ</h2>
<p><img src="/assets/introduction-to-AST/ast-overview.png" alt="ast-process"></p>
<p>å¤§ã¾ã‹ã«åˆ†ã‘ã¦ä»¥ä¸‹ã®ä¸‰ã¤ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚</p>
<ul>
<li>parse: JS -> AST</li>
<li>transform: transform AST</li>
<li>unparse: AST -> JS</li>
</ul>
<p><code>parse</code> ã®æ®µéšã§, JavaScriptã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ AST ã¸ã¨å¤‰æ›ã—ã¾ã™.
<code>transform</code> ã®æ®µéšã§, AST ã®ä¸­èº«ã‚’å¼„ã£ã¦ã„ãã¾ã™.
ãã—ã¦æœ€å¾Œã« <code>unparse</code> ã®æ®µéšã§ transform ã•ã‚ŒãŸ AST ã‚’ JavaScript ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¸ã¨å¤‰æ›ã—ã¦ãã‚Œã¾ã™.</p>
<p><img src="/assets/introduction-to-AST/transform.png" alt="ast_process2"></p>
<p>ã¾ãŸ, å¤šãã®å ´åˆå…ˆäººã®å¼›ã¾ã¬åŠªåŠ›ã®ãŠã‹ã’ã§, <code>parse</code>, <code>unparse</code> ã«ã¤ã„ã¦ã¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã»ã¼ã»ã¼æ‹…ã£ã¦ãã‚Œã¦ã„ã¦, å®Ÿè£…è€…ãŒã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã«ã¤ã„ã¦è€ƒãˆã‚‹ã“ã¨ã¯å°‘ãªã„ã§ã™.</p>
<p>ã§ã¯å®Ÿéš›ã« <code>parse</code> ã¨ <code>unparse</code> ã ã‘è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†.</p>
<h2 id="2__4">ASTã‚’è©¦ã—ã¦ã¿ã‚‹</h2>
<p>æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚å®Ÿè¡Œç’°å¢ƒã¯ Node.js ä¸Šã§ã™.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> { parse } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"@babel/parser"</span>);

<span class="hljs-keyword">const</span> code = <span class="hljs-string">`
if(hoge === "bar") {
  fuga();
}
`</span>

<span class="hljs-comment">// JSã‚’ASTã«parseã™ã‚‹</span>
<span class="hljs-keyword">const</span> ast = <span class="hljs-title function_">parser</span>(code);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">dir</span>(ast, { <span class="hljs-attr">depth</span>: <span class="hljs-literal">null</span> });
</code></pre>
<p>ã™ã‚‹ã¨ã“ã‚“ãªå‡ºåŠ›ãŒå‡ºã‚‹ã¨æ€ã„ã¾ã™ã€‚(éš…ã‹ã‚‰éš…ã¾ã§èª­ã¾ãªãã¦ã‚‚å¤§ä¸ˆå¤«ã§ã™)</p>
<pre><code class="hljs language-javascript"><span class="hljs-title class_">Node</span> {
  <span class="hljs-attr">type</span>: <span class="hljs-string">'File'</span>,
  <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">end</span>: <span class="hljs-number">34</span>,
  <span class="hljs-attr">loc</span>: <span class="hljs-title class_">SourceLocation</span> {
    <span class="hljs-attr">start</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">0</span> },
    <span class="hljs-attr">end</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">0</span> },
    <span class="hljs-attr">filename</span>: <span class="hljs-literal">undefined</span>,
    <span class="hljs-attr">identifierName</span>: <span class="hljs-literal">undefined</span>
  },
  <span class="hljs-attr">range</span>: <span class="hljs-literal">undefined</span>,
  <span class="hljs-attr">leadingComments</span>: <span class="hljs-literal">undefined</span>,
  <span class="hljs-attr">trailingComments</span>: <span class="hljs-literal">undefined</span>,
  <span class="hljs-attr">innerComments</span>: <span class="hljs-literal">undefined</span>,
  <span class="hljs-attr">extra</span>: <span class="hljs-literal">undefined</span>,
  <span class="hljs-attr">errors</span>: [],
  <span class="hljs-attr">program</span>: <span class="hljs-title class_">Node</span> {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'Program'</span>,
    <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">end</span>: <span class="hljs-number">34</span>,
    <span class="hljs-attr">loc</span>: <span class="hljs-title class_">SourceLocation</span> {
      <span class="hljs-attr">start</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">0</span> },
      <span class="hljs-attr">end</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">0</span> },
      <span class="hljs-attr">filename</span>: <span class="hljs-literal">undefined</span>,
      <span class="hljs-attr">identifierName</span>: <span class="hljs-literal">undefined</span>
    },
    <span class="hljs-attr">range</span>: <span class="hljs-literal">undefined</span>,
    <span class="hljs-attr">leadingComments</span>: <span class="hljs-literal">undefined</span>,
    <span class="hljs-attr">trailingComments</span>: <span class="hljs-literal">undefined</span>,
    <span class="hljs-attr">innerComments</span>: <span class="hljs-literal">undefined</span>,
    <span class="hljs-attr">extra</span>: <span class="hljs-literal">undefined</span>,
    <span class="hljs-attr">sourceType</span>: <span class="hljs-string">'script'</span>,
    <span class="hljs-attr">interpreter</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">body</span>: [
      <span class="hljs-title class_">Node</span> {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'IfStatement'</span>,
        <span class="hljs-attr">start</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">end</span>: <span class="hljs-number">33</span>,
        <span class="hljs-attr">loc</span>: <span class="hljs-title class_">SourceLocation</span> {
          <span class="hljs-attr">start</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">0</span> },
          <span class="hljs-attr">end</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">1</span> },
          <span class="hljs-attr">filename</span>: <span class="hljs-literal">undefined</span>,
          <span class="hljs-attr">identifierName</span>: <span class="hljs-literal">undefined</span>
        },
        <span class="hljs-attr">range</span>: <span class="hljs-literal">undefined</span>,
        <span class="hljs-attr">leadingComments</span>: <span class="hljs-literal">undefined</span>,
        <span class="hljs-attr">trailingComments</span>: <span class="hljs-literal">undefined</span>,
        <span class="hljs-attr">innerComments</span>: <span class="hljs-literal">undefined</span>,
        <span class="hljs-attr">extra</span>: <span class="hljs-literal">undefined</span>,
        <span class="hljs-attr">test</span>: <span class="hljs-title class_">Node</span> {
          <span class="hljs-attr">type</span>: <span class="hljs-string">'BinaryExpression'</span>,
          <span class="hljs-attr">start</span>: <span class="hljs-number">4</span>,
          <span class="hljs-attr">end</span>: <span class="hljs-number">18</span>,
          <span class="hljs-attr">loc</span>: <span class="hljs-title class_">SourceLocation</span> {
            <span class="hljs-attr">start</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">3</span> },
            <span class="hljs-attr">end</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">17</span> },
            <span class="hljs-attr">filename</span>: <span class="hljs-literal">undefined</span>,
            <span class="hljs-attr">identifierName</span>: <span class="hljs-literal">undefined</span>
          },
          <span class="hljs-attr">range</span>: <span class="hljs-literal">undefined</span>,
          <span class="hljs-attr">leadingComments</span>: <span class="hljs-literal">undefined</span>,
          <span class="hljs-attr">trailingComments</span>: <span class="hljs-literal">undefined</span>,
          <span class="hljs-attr">innerComments</span>: <span class="hljs-literal">undefined</span>,
          <span class="hljs-attr">extra</span>: <span class="hljs-literal">undefined</span>,
          <span class="hljs-attr">left</span>: <span class="hljs-title class_">Node</span> {
            <span class="hljs-attr">type</span>: <span class="hljs-string">'Identifier'</span>,
            <span class="hljs-attr">start</span>: <span class="hljs-number">4</span>,
            <span class="hljs-attr">end</span>: <span class="hljs-number">8</span>,
            <span class="hljs-attr">loc</span>: <span class="hljs-title class_">SourceLocation</span> {
              <span class="hljs-attr">start</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">3</span> },
              <span class="hljs-attr">end</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">7</span> },
              <span class="hljs-attr">filename</span>: <span class="hljs-literal">undefined</span>,
              <span class="hljs-attr">identifierName</span>: <span class="hljs-string">'hoge'</span>
            },
            <span class="hljs-attr">range</span>: <span class="hljs-literal">undefined</span>,
            <span class="hljs-attr">leadingComments</span>: <span class="hljs-literal">undefined</span>,
            <span class="hljs-attr">trailingComments</span>: <span class="hljs-literal">undefined</span>,
            <span class="hljs-attr">innerComments</span>: <span class="hljs-literal">undefined</span>,
            <span class="hljs-attr">extra</span>: <span class="hljs-literal">undefined</span>,
            <span class="hljs-attr">name</span>: <span class="hljs-string">'hoge'</span>
          },
          <span class="hljs-attr">operator</span>: <span class="hljs-string">'==='</span>,
          <span class="hljs-attr">right</span>: <span class="hljs-title class_">Node</span> {
            <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>,
            <span class="hljs-attr">start</span>: <span class="hljs-number">13</span>,
            <span class="hljs-attr">end</span>: <span class="hljs-number">18</span>,
            <span class="hljs-attr">loc</span>: <span class="hljs-title class_">SourceLocation</span> {
              <span class="hljs-attr">start</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">12</span> },
              <span class="hljs-attr">end</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">17</span> },
              <span class="hljs-attr">filename</span>: <span class="hljs-literal">undefined</span>,
              <span class="hljs-attr">identifierName</span>: <span class="hljs-literal">undefined</span>
            },
            <span class="hljs-attr">range</span>: <span class="hljs-literal">undefined</span>,
            <span class="hljs-attr">leadingComments</span>: <span class="hljs-literal">undefined</span>,
            <span class="hljs-attr">trailingComments</span>: <span class="hljs-literal">undefined</span>,
            <span class="hljs-attr">innerComments</span>: <span class="hljs-literal">undefined</span>,
            <span class="hljs-attr">extra</span>: { <span class="hljs-attr">rawValue</span>: <span class="hljs-string">'bar'</span>, <span class="hljs-attr">raw</span>: <span class="hljs-string">'"bar"'</span> },
            <span class="hljs-attr">value</span>: <span class="hljs-string">'bar'</span>
          }
        },
        <span class="hljs-attr">consequent</span>: <span class="hljs-title class_">Node</span> {
          <span class="hljs-attr">type</span>: <span class="hljs-string">'BlockStatement'</span>,
          <span class="hljs-attr">start</span>: <span class="hljs-number">20</span>,
          <span class="hljs-attr">end</span>: <span class="hljs-number">33</span>,
          <span class="hljs-attr">loc</span>: <span class="hljs-title class_">SourceLocation</span> {
            <span class="hljs-attr">start</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">19</span> },
            <span class="hljs-attr">end</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">1</span> },
            <span class="hljs-attr">filename</span>: <span class="hljs-literal">undefined</span>,
            <span class="hljs-attr">identifierName</span>: <span class="hljs-literal">undefined</span>
          },
          <span class="hljs-attr">range</span>: <span class="hljs-literal">undefined</span>,
          <span class="hljs-attr">leadingComments</span>: <span class="hljs-literal">undefined</span>,
          <span class="hljs-attr">trailingComments</span>: <span class="hljs-literal">undefined</span>,
          <span class="hljs-attr">innerComments</span>: <span class="hljs-literal">undefined</span>,
          <span class="hljs-attr">extra</span>: <span class="hljs-literal">undefined</span>,
          <span class="hljs-attr">body</span>: [
            <span class="hljs-title class_">Node</span> {
              <span class="hljs-attr">type</span>: <span class="hljs-string">'ExpressionStatement'</span>,
              <span class="hljs-attr">start</span>: <span class="hljs-number">24</span>,
              <span class="hljs-attr">end</span>: <span class="hljs-number">31</span>,
              <span class="hljs-attr">loc</span>: <span class="hljs-title class_">SourceLocation</span> {
                <span class="hljs-attr">start</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">2</span> },
                <span class="hljs-attr">end</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">9</span> },
                <span class="hljs-attr">filename</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">identifierName</span>: <span class="hljs-literal">undefined</span>
              },
              <span class="hljs-attr">range</span>: <span class="hljs-literal">undefined</span>,
              <span class="hljs-attr">leadingComments</span>: <span class="hljs-literal">undefined</span>,
              <span class="hljs-attr">trailingComments</span>: <span class="hljs-literal">undefined</span>,
              <span class="hljs-attr">innerComments</span>: <span class="hljs-literal">undefined</span>,
              <span class="hljs-attr">extra</span>: <span class="hljs-literal">undefined</span>,
              <span class="hljs-attr">expression</span>: <span class="hljs-title class_">Node</span> {
                <span class="hljs-attr">type</span>: <span class="hljs-string">'CallExpression'</span>,
                <span class="hljs-attr">start</span>: <span class="hljs-number">24</span>,
                <span class="hljs-attr">end</span>: <span class="hljs-number">30</span>,
                <span class="hljs-attr">loc</span>: <span class="hljs-title class_">SourceLocation</span> {
                  <span class="hljs-attr">start</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">2</span> },
                  <span class="hljs-attr">end</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">8</span> },
                  <span class="hljs-attr">filename</span>: <span class="hljs-literal">undefined</span>,
                  <span class="hljs-attr">identifierName</span>: <span class="hljs-literal">undefined</span>
                },
                <span class="hljs-attr">range</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">leadingComments</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">trailingComments</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">innerComments</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">extra</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">callee</span>: <span class="hljs-title class_">Node</span> {
                  <span class="hljs-attr">type</span>: <span class="hljs-string">'Identifier'</span>,
                  <span class="hljs-attr">start</span>: <span class="hljs-number">24</span>,
                  <span class="hljs-attr">end</span>: <span class="hljs-number">28</span>,
                  <span class="hljs-attr">loc</span>: <span class="hljs-title class_">SourceLocation</span> {
                    <span class="hljs-attr">start</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">2</span> },
                    <span class="hljs-attr">end</span>: <span class="hljs-title class_">Position</span> { <span class="hljs-attr">line</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">column</span>: <span class="hljs-number">6</span> },
                    <span class="hljs-attr">filename</span>: <span class="hljs-literal">undefined</span>,
                    <span class="hljs-attr">identifierName</span>: <span class="hljs-string">'fuga'</span>
                  },
                  <span class="hljs-attr">range</span>: <span class="hljs-literal">undefined</span>,
                  <span class="hljs-attr">leadingComments</span>: <span class="hljs-literal">undefined</span>,
                  <span class="hljs-attr">trailingComments</span>: <span class="hljs-literal">undefined</span>,
                  <span class="hljs-attr">innerComments</span>: <span class="hljs-literal">undefined</span>,
                  <span class="hljs-attr">extra</span>: <span class="hljs-literal">undefined</span>,
                  <span class="hljs-attr">name</span>: <span class="hljs-string">'fuga'</span>
                },
                <span class="hljs-attr">arguments</span>: []
              }
            }
          ],
          <span class="hljs-attr">directives</span>: []
        },
        <span class="hljs-attr">alternate</span>: <span class="hljs-literal">null</span>
      }
    ],
    <span class="hljs-attr">directives</span>: []
  },
  <span class="hljs-attr">comments</span>: []
}
</code></pre>
<p>ç¢ºã‹ã«, <code>ifStatement</code> ã®ãªã‹ã«, <code>test</code> (å›³ã§è¨€ã†ã¨ã“ã‚ã®æ¡ä»¶) ãŒã‚ã‚Š, ã•ã‚‰ã« <code>consequent</code> (å›³ã§è¨€ã†ã¨ã“ã‚ã®then) ãŒã‚ã‚Š, <code>test</code> ã®ä¸­ã« <code>BinaryExpression</code> (å›³ã§è¨€ã†ã¨ã“ã‚ã®äºŒé …æ¼”ç®—å­) ãŒã‚ã£ã¦, ã¨ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã‚‹ã¨æ€ã„ã¾ã™.</p>
<p>ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ä¹—ã£ã‹ã‚‹ã ã‘ã§, JavaScriptã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ AST ã¸ã¨ç°¡å˜ã« <code>parse</code> ã§ããŸã®ãŒä½“æ„Ÿã§ããŸã¨æ€ã„ã¾ã™.</p>
<p>æ¬¡ã« <code>unparse</code> ã‚‚ã‚„ã£ã¦ã¿ã¾ã—ã‚‡ã†.
å…ˆã»ã©ã®ã‚³ãƒ¼ãƒ‰ã‚’æ¬¡ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã¦ã¿ã¦ãã ã•ã„.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> { parse } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"@babel/parser"</span>);
<span class="hljs-keyword">const</span> { <span class="hljs-attr">default</span>: generate } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"@babel/generator"</span>);

<span class="hljs-keyword">const</span> code = <span class="hljs-string">`
if(hoge === "bar") {
  fuga();
}
`</span>

<span class="hljs-keyword">const</span> ast = <span class="hljs-title function_">parser</span>(code);

<span class="hljs-comment">// ASTã‚’JSã¸ã¨unparseã™ã‚‹</span>
<span class="hljs-keyword">const</span> { <span class="hljs-attr">code</span>: output } = <span class="hljs-title function_">generate</span>(ast);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(output)

</code></pre>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">if</span> (hoge === <span class="hljs-string">"bar"</span>) {
  <span class="hljs-title function_">fuga</span>();
}
</code></pre>
<p>ã“ã®ã‚ˆã†ãª, å…¥åŠ›ã—ãŸcodeã¨å…¨ãåŒã˜codeãŒå‡ºåŠ›ã•ã‚ŒãŸã¨æ€ã„ã¾ã™. ç°¡å˜ã§ã™ã­.</p>
<p>ã§ã¯æ¬¡ã«å®Ÿéš›ã«ã‚³ãƒ¼ãƒ‰ã‚’ã„ã˜ã„ã˜ã—ã¦ã¿ã¾ã—ã‚‡ã†.</p>
<p>ä»Šå›ã¯ç°¡å˜ã«, å¤‰æ•°ã‚’å…¨éƒ¨çµµæ–‡å­—ã«ã—ã¦ãã‚Œã‚‹å›ã‚’ä½œã£ã¦ã¿ã¾ã™.</p>
<p>ä»Šå›ã‚„ã‚ŠãŸã„ã“ã¨ã®ä¸‹æº–å‚™ã¨ã—ã¦, ä»¥ä¸‹ã®ã‚ˆã†ãªclassã‚’ç”¨æ„ã—ã¦ãã ã•ã„.
ã“ã‚Œã¯textã‚’æ¸¡ã™ã¨çµµæ–‡å­—ã«å¤‰æ›ã—ã¦ãã‚Œã‚‹å›ã§ã™.
ä»¥å‰å¤‰æ›ã—ãŸã“ã¨ã®ã‚ã‚‹textã‚’æ¸¡ã™ã¨, ãã®ã¨ãã®çµµæ–‡å­—ã‚’è¿”ã—ã¦ãã‚Œã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™.
ã“ã®ã‚³ãƒ¼ãƒ‰è‡ªä½“ã¯ã“ã®ãƒ–ãƒ­ã‚°ã®æœ¬æ—¨ã‹ã‚‰å¤–ã‚Œã‚‹ã®ã§èª­ã‚€å¿…è¦ã¯ãªã„ã§ã™.</p>
<pre><code class="hljs language-javascript">
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Text2Emoji</span> {
  emojis;
  textMap;
  baseNumber;
  idx;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) {
    <span class="hljs-keyword">if</span>(props.<span class="hljs-property">emojis</span>.<span class="hljs-property">length</span> &#x3C; <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"emojis should be more than 1"</span>)
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">emojis</span> = props.<span class="hljs-property">emojis</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">textMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">textMap</span>.<span class="hljs-title function_">set</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">baseNumber</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">emojis</span>.<span class="hljs-property">length</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">idx</span> = <span class="hljs-number">0</span>;
  }

  <span class="hljs-title function_">convert</span>(<span class="hljs-params">text</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_isRegistered</span>(text)) {
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">textMap</span>.<span class="hljs-title function_">get</span>(text);
    }

    <span class="hljs-keyword">const</span> emoji = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_num2Emoji</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">idx</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">idx</span> += <span class="hljs-number">1</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">textMap</span>.<span class="hljs-title function_">set</span>(text, emoji);
    <span class="hljs-keyword">return</span> emoji;

  }

  <span class="hljs-title function_">_isRegistered</span>(<span class="hljs-params">text</span>) {
    <span class="hljs-keyword">return</span> !!<span class="hljs-variable language_">this</span>.<span class="hljs-property">textMap</span>.<span class="hljs-title function_">get</span>(text);
  }

  <span class="hljs-title function_">_num2Emoji</span>(<span class="hljs-params">num</span>) {
    <span class="hljs-keyword">const</span> convertedNum = num.<span class="hljs-title function_">toString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">baseNumber</span>).<span class="hljs-title function_">split</span>(<span class="hljs-string">""</span>);
    <span class="hljs-keyword">const</span> key = convertedNum.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">el</span>) =></span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">emojis</span>[el]).<span class="hljs-title function_">join</span>(<span class="hljs-string">""</span>);
    <span class="hljs-keyword">return</span> key
  }
}

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-title class_">Text2Emoji</span>
}

</code></pre>
<p>ã§ã¯, <code>transform</code> ã®éƒ¨åˆ†ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†.
ã¾ãšã“ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã¦ãã ã•ã„.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> { parse } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"@babel/parser"</span>);
<span class="hljs-keyword">const</span> { <span class="hljs-attr">default</span>: generate } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"@babel/generator"</span>);
<span class="hljs-comment">// transform ã«å¿…è¦ãª @babel/traverse ã‚’import</span>
<span class="hljs-keyword">const</span> { <span class="hljs-attr">default</span>: traverse } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"@babel/traverse"</span>);

<span class="hljs-comment">// ã„ã˜ã„ã˜ã™ã‚‹å¯¾è±¡ã®ã‚³ãƒ¼ãƒ‰</span>
<span class="hljs-keyword">const</span> code = <span class="hljs-string">`
const NAME = "Shinyaigeek";
const JOB = "frontend engineer";
const INTERESTS =  ["web performance", "AST", "Usability"]
const AGE= 21;

const hey = () => {
    return \`Hi!! there!! My name is \${NAME}. I'm \${JOB}. I'm \${AGE} years old.My interests are \${INTERESTS.map(interest => interest + "/")}\`
}

console.log(hey());
`</span>

<span class="hljs-keyword">const</span> ast = <span class="hljs-title function_">parser</span>(code);

<span class="hljs-keyword">const</span> visitor = {};

<span class="hljs-comment">// ASTã‚’èµ°æŸ»ã—ã¦, ç‰¹å®šNodeã«ã¤ã„ã¦å‡¦ç†ã‚’è¡Œã†</span>
<span class="hljs-title function_">traverse</span>(ast, visitor);

<span class="hljs-keyword">const</span> { <span class="hljs-attr">code</span>: output } = <span class="hljs-title function_">generate</span>(ast);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(output)
</code></pre>
<p>ãã†ã™ã‚‹ã¨, ã•ã£ãå®Ÿè¡Œã—ãŸJavaScriptã¨åŒã˜å‡ºåŠ›ãŒã•ã‚ŒãŸã¨æ€ã„ã¾ã™.
<code>transform</code> ã§, astã«å¯¾ã—ã¦ç ´å£Šçš„å¤‰æ›´ã‚’è¡Œã„, ãã®çµæœã®ASTã‚’ <code>generate</code> é–¢æ•°ã«æ¸¡ã™ã®ã§ã™ãŒ, ä»Šå›ã¯å¤‰æ›ã®å‡¦ç†ã‚’ä½•ã‚‚ã—ã¦ã„ã¾ã›ã‚“.</p>
<p>æ¬¡ã«å¤‰æ›ã®å‡¦ç†ã‚’æ›¸ã„ã¦ã„ãã¾ã™.</p>
<p><code>@babel/traverse</code> ã ã¨, visitor patternã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™.
visitor patternã¨è¨€ã†ã®ã¯, èµ°æŸ»å¯¾è±¡ã®ç‰¹å®šéƒ¨åˆ†ã« <strong>è¨ªå•</strong> ã—ã¦ã„ã <code>visitor object</code> ã«å‡¦ç†ã‚’è¨˜è¿°ã—ã¦, ãã®å‡¦ç†ã‚’ç‰¹å®šéƒ¨åˆ†ã§å®Ÿè¡Œã—ã¦ã„ã, ã¨è¨€ã†ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã“ã¨ã§ã™.
ãƒ†ãƒ¬ãƒ“ã®é›†é‡‘ã‚’ä¾‹ã«å‡ºã™ã¨, ã‚ã‚‹ãƒ†ãƒ¬ãƒ“å±€ã®é›»æ³¢ã‚’å—è¨ºã—ã¦ã„ã‚‹å®¶åº­ã«, å–ã‚Šç«‹ã¦äººãŒ <strong>è¨ªå•</strong> ã—ã¦, æ–™é‡‘ã‚’å–ã‚Šç«‹ã¦ã‚‹ã¨è¨€ã† <strong>å‡¦ç†</strong> ã‚’å®Ÿè¡Œã—ã¦ã„ãã¨è¨€ã†ã“ã¨ã«ãªã‚Šã¾ã™ã­.
å–ã‚Šç«‹ã¦äººã¯, ãƒ†ãƒ¬ãƒ“å±€ã®é›»æ³¢ã‚’å—è¨ºã—ã¦ã„ãªã„å®¶åº­ã§ã¯å–ã‚Šç«‹ã¦ã¨è¨€ã† <strong>å‡¦ç†</strong> ã¯å®Ÿè¡Œã—ãªã„ã§ã™ã­.</p>
<p>ç™¾èã¯ä¸€è¦‹ã«ã—ã‹ãšã¨ã„ã†ã“ã¨ã§, æ—©é€Ÿå®Ÿéš›ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦è©¦ã—ã¦ã„ãã¾ã—ã‚‡ã†.
æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã¦ãã ã•ã„.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> { parse } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"@babel/parser"</span>);
<span class="hljs-keyword">const</span> { <span class="hljs-attr">default</span>: generate } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"@babel/generator"</span>);
<span class="hljs-keyword">const</span> { <span class="hljs-attr">default</span>: traverse } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"@babel/traverse"</span>);

<span class="hljs-keyword">const</span> code = <span class="hljs-string">`
const NAME = "Shinyaigeek";
const JOB = "frontend engineer";
const INTERESTS =  ["web performance", "AST", "Usability"]
const AGE= 21;

const hey = () => {
    return \`Hi!! there!! My name is \${NAME}. I'm \${JOB}. I'm \${AGE} years old.My interests are \${INTERESTS.map(interest => interest + "/")}\`
}

console.log(hey());
`</span>

<span class="hljs-keyword">const</span> ast = <span class="hljs-title function_">parse</span>(code);

<span class="hljs-keyword">const</span> { <span class="hljs-attr">code</span>: output } = <span class="hljs-title function_">generate</span>(ast);

<span class="hljs-comment">// visitor patternã‚’æ›¸ãè¾¼ã‚“ã§ã„ã</span>
<span class="hljs-keyword">const</span> visitor = {
    <span class="hljs-comment">// Identifier ã«è¨ªå•ã™ã‚‹ visitor ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</span>
    <span class="hljs-title class_">Identifier</span>(nodePath) {
        <span class="hljs-comment">// visitor objectã§è¡Œã†å‡¦ç†</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(nodePath.<span class="hljs-property">node</span>.<span class="hljs-property">type</span> + <span class="hljs-string">": "</span> + nodePath.<span class="hljs-property">node</span>.<span class="hljs-property">name</span>)
    }
};

<span class="hljs-title function_">traverse</span>(ast, visitor);
</code></pre>
<p>ã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ãªå‡ºåŠ›ãŒå‡ºã‚‹ã¨æ€ã„ã¾ã™.</p>
<pre><code class="hljs language-shell">Identifier: NAME
Identifier: JOB
Identifier: INTERESTS
Identifier: AGE
Identifier: hey
Identifier: NAME
Identifier: JOB
Identifier: AGE
Identifier: INTERESTS
Identifier: map
Identifier: interest
Identifier: interest
Identifier: console
Identifier: log
Identifier: hey
</code></pre>
<p>ã“ã‚Œã§å…¨ã¦ã®è­˜åˆ¥å­ã« <strong>è¨ªå•</strong> ã—ã¦, ãã®è­˜åˆ¥å­ã®åå‰ã‚’logã§å‡ºåŠ›ã—ã¦ã„ã‚‹ã¨ã„ã†ã®ãŒã‚ã‹ã‚Šã¾ã™ã­.
æ¬¡ã«, log ã«å‡ºã™ã ã‘ã§ã¯ãªã, å®Ÿéš›ã« AST ã® transform ã‚’è¡Œãªã£ã¦ã„ãã¾ã—ã‚‡ã†.</p>
<p>æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã¦ãã ã•ã„.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> { parse } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"@babel/parser"</span>);
<span class="hljs-keyword">const</span> { <span class="hljs-attr">default</span>: generate } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"@babel/generator"</span>);
<span class="hljs-keyword">const</span> { <span class="hljs-attr">default</span>: traverse } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"@babel/traverse"</span>);
<span class="hljs-keyword">const</span> { <span class="hljs-title class_">Text2Emoji</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./Text2Emoji"</span>);

<span class="hljs-comment">// textã‚’çµµæ–‡å­—ã«ã—ã¦ãã‚Œã‚‹å›</span>
<span class="hljs-keyword">const</span> converter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Text2Emoji</span>({
  <span class="hljs-attr">emojis</span>: [<span class="hljs-string">"ğŸˆ"</span>, <span class="hljs-string">"ğŸ¦"</span>, <span class="hljs-string">"ğŸµ"</span>, <span class="hljs-string">"ğŸ¶"</span>]
})

<span class="hljs-keyword">const</span> code = <span class="hljs-string">`
const NAME = "Shinyaigeek";
const JOB = "frontend engineer";
const INTERESTS =  ["web performance", "AST", "Usability"]
const AGE= 21;

const hey = () => {
    return \`Hi!! there!! My name is \${NAME}. I'm \${JOB}. I'm \${AGE} years old.My interests are \${INTERESTS.map(interest => interest + "/")}\`
}

console.log(hey());
`</span>

<span class="hljs-keyword">const</span> ast = <span class="hljs-title function_">parse</span>(code);

<span class="hljs-keyword">const</span> { <span class="hljs-attr">code</span>: output } = <span class="hljs-title function_">generate</span>(ast);

<span class="hljs-keyword">const</span> visitor = {
    <span class="hljs-title class_">Identifier</span>(nodePath) {
        <span class="hljs-comment">// visitor objectã§è¡Œã†å‡¦ç†</span>
        <span class="hljs-comment">// è­˜åˆ¥å­ã®åå‰ã‚’çµµæ–‡å­—ã«ã™ã‚‹</span>
        <span class="hljs-keyword">const</span> emoji = converter.<span class="hljs-title function_">convert</span>(nodePath.<span class="hljs-property">node</span>.<span class="hljs-property">name</span>);
        <span class="hljs-comment">// è¨ªå•ã—ãŸè­˜åˆ¥å­ã‚’, åå‰ãŒçµµæ–‡å­—ã«ãªã£ãŸè­˜åˆ¥å­ã«ç½®ãæ›ãˆã‚‹</span>
        nodePath.<span class="hljs-title function_">replaceWith</span>(
          <span class="hljs-title function_">identifier</span>(emoji)
        )
        <span class="hljs-comment">// åå‰ãŒã™ã§ã«çµµæ–‡å­—ã«ãªã£ãŸè­˜åˆ¥å­ã‚’å†åº¦è¨ªå•ã—ãªã„ã‚ˆã†ã«, skip ã™ã‚‹</span>
        nodePath.<span class="hljs-title function_">skip</span>();
    }
};

<span class="hljs-title function_">traverse</span>(ast, visitor);

<span class="hljs-keyword">const</span> { <span class="hljs-attr">code</span>: output } = <span class="hljs-title function_">generate</span>(ast)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(output);
</code></pre>
<p>ã™ã‚‹ã¨ã“ã®ã‚ˆã†ãªå‡ºåŠ›ãŒå‡ºãŸã¨æ€ã„ã¾ã™.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> ğŸˆ = <span class="hljs-string">"Shinyaigeek"</span>;
<span class="hljs-keyword">const</span> ğŸ¦ = <span class="hljs-string">"frontend engineer"</span>;
<span class="hljs-keyword">const</span> ğŸµ = [<span class="hljs-string">"web performance"</span>, <span class="hljs-string">"AST"</span>, <span class="hljs-string">"Usability"</span>];
<span class="hljs-keyword">const</span> ğŸ¶ = <span class="hljs-number">21</span>;

<span class="hljs-keyword">const</span> ğŸ¦ğŸˆ = <span class="hljs-function">() =></span> {
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hi!! there!! My name is <span class="hljs-subst">${ğŸˆ}</span>. I'm <span class="hljs-subst">${ğŸ¦}</span>. I'm <span class="hljs-subst">${ğŸ¶}</span> years old.My interests are <span class="hljs-subst">${ğŸµ.ğŸ¦ğŸ¦((ğŸ¦ğŸµ) => ğŸ¦ğŸµ + <span class="hljs-string">"/"</span>)}</span>`</span>;
};

ğŸ¦ğŸ¶.ğŸµğŸˆ(ğŸ¦ğŸˆ());
</code></pre>
<p>ãŠï¼ï¼è­˜åˆ¥å­ãŒçµµæ–‡å­—ã«å¤‰æ›ã•ã‚Œã¦ãã‚Œã¦ã¾ã™ã­ï¼ï¼
å„è­˜åˆ¥å­ãŒã¡ã‚ƒã‚“ã¨å¯¾å¿œã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã¿ã¦ãã ã•ã„.</p>
<p>ä»Šå›ã¯å¤‰æ•°å…¨éƒ¨çµµæ–‡å­—ã«ã™ã‚‹å›ã¨ã„ã†ã‹ãªã‚Šã—ã‚‡ã†ã‚‚ãªã„ãƒ„ãƒ¼ãƒ«ã‚’ä½œã£ãŸã ã‘ã§ã™ãŒ, è³¢ã„äººãªã‚‰ã‚ã‚Œã‚‚ã§ããã†ã“ã‚Œã‚‚ã§ããã†ã¨, ä½•ã‹ã‚¢ã‚¤ãƒ‡ã‚£ã‚¢ãŒæµ®ã‹ã³ä¸ŠãŒã£ãŸã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã­.</p>
<h2 id="2__5">ã¾ã¨ã‚</h2>
<p>ASTã‚’è§¦ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã¨, è‡ªåˆ†ã®é–‹ç™ºè€…ä½“é¨“ã‚’è‡ªåˆ†ã§å®ˆã£ã¦ã„ãã¨ã„ã†ã‚¨ã‚­ã‚µã‚¤ãƒ†ã‚£ãƒ³ã‚°ãªä½“é¨“ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™.
Let's AST!!</p></div><div class="XTxSDCE1gmhoF59UaA7g"><div class="mdGYkZO2YHxhxRXU338z"><div class="O6UishUpXe8xGlTrCl8G"><img src="/assets/static/icon_transparent.png" class="J5UgGRYhWe9JWeYlm2bw" alt="monkey-icon" width="270px" height="270px"></div><div class="cab8_7jeBIe5dRHd8ikS"><div class="kEage_DVZV_Stt0z3eAT"><div class="_5U8hWpqU834VUiKxwCpA"><img src="/assets/static/earth.png" alt="earth" width="50px" height="50px"></div></div></div></div><div class="baseprofile"><div class="_pakeuUKwDGIGV1PIDFI">Hi <span role="img" aria-label="wave hand">ğŸ‘‹</span> I&#x27;m <span class="zQUgJkaqGKzVRFrvk7mk">Shinobu Hayashi a.k.a Shinyaigeek(ã—ã«ã‚ƒã„)</span>.</div><div class="CMC6WyjhCeKfvY5zyyq0"><span data-text="Web Developer" class="v7yavk2O9dr3NZXn186P">Web Developer</span> <g-emoji fallback-src="/assets/static/spider_web.png" alias="spider-web">ğŸ•¸</g-emoji> / <span data-text="Reliable web Enthusiast" class="v7yavk2O9dr3NZXn186P">Reliable Web Enthusiast</span> <g-emoji fallback-src="/assets/static/fire.png" alias="fire">ğŸ”¥</g-emoji> </div><div class="gA7tXpIz5V3YPffc9WIr">Faster, Lighter, More accessible, More secure, More productive Web for anyone, anytime , anywhere.</div><div class="v0ZqRqZjlqevKrsWtDTt"><div class="zdvavtYkqc1dXYPR1y0c"><a id="twitter" href="https://twitter.com/Shinyaigeek"><img src="/assets/static/twitter.svg" alt="twitter" width="54px" height="54px"></a></div><div class="zdvavtYkqc1dXYPR1y0c"><a id="github" href="https://github.com/Shinyaigeek"><img src="/assets/static/github.svg" alt="github" width="54px" height="54px"></a></div><div class="zdvavtYkqc1dXYPR1y0c"><a id="linkedin" href="https://www.linkedin.com/in/shinyaigeek/"><img src="/assets/static/linkedin.svg" alt="linkedin" width="54px" height="54px"></a></div></div><div class="l5KzSvykijElHJc7q2c9"><a href="mailto:me@shinyaigeek.dev">Contact Me on Email <g-emoji fallback-src="/assets/static/email.png" alias="email">ğŸ“§</g-emoji></a></div></div></div></div></div><div class="AJQSVdi_FHylcHDbYLWV">Copyright. 2022 Shinyaigeek</div></div></div></body><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;0893ac88cf0542af88bfd9b93008b408&quot;, &quot;spa&quot;: true}"></script><script defer="" src="/assets/r.a0d01c88f547277aab5a.js" async=""></script></html>